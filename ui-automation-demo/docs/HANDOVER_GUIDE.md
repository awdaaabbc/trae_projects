# é¡¹ç›®å¤ç›˜ä¸ä»£ç å¯¼è¯»æŒ‡å— (Handover Guide)

> æœ¬æ–‡æ¡£æ—¨åœ¨å¸®åŠ©å›¢é˜Ÿå¿«é€Ÿäº†è§£é¡¹ç›®æˆæœã€è®¾è®¡æ€è·¯åŠä»£ç ç»†èŠ‚ï¼ŒåŒæ—¶ä¹Ÿå¯ä½œä¸ºå®ä¹ /é¡¹ç›®æ€»ç»“æ±‡æŠ¥çš„æ ¸å¿ƒç´ æã€‚

---

## 1. é¡¹ç›®èƒŒæ™¯ä¸ç—›ç‚¹ (Situation & Task)

åœ¨ä¼ ç»Ÿçš„ UI è‡ªåŠ¨åŒ–æµ‹è¯•ä¸­ï¼Œæˆ‘ä»¬é¢ä¸´ä»¥ä¸‹æ ¸å¿ƒç—›ç‚¹ï¼š

*   **é—¨æ§›é«˜**ï¼šç¼–å†™æµ‹è¯•è„šæœ¬éœ€è¦æŒæ¡ Playwright/Selenium ç­‰æ¡†æ¶ APIï¼Œä»¥åŠå¤æ‚çš„ CSS/XPath é€‰æ‹©å™¨ã€‚
*   **ç»´æŠ¤éš¾**ï¼šé¡µé¢ UI ç¨æœ‰æ”¹åŠ¨ï¼ˆå¦‚ ID å˜åŒ–ã€å±‚çº§è°ƒæ•´ï¼‰ï¼Œç¡¬ç¼–ç çš„é€‰æ‹©å™¨å°±ä¼šå¤±æ•ˆï¼Œå¯¼è‡´è„šæœ¬è„†å¼±ã€‚
*   **è¦†ç›–çª„**ï¼šé€šå¸¸ä»…è¦†ç›– Web ç«¯ï¼Œç¼ºä¹å¯¹ç§»åŠ¨ç«¯ï¼ˆAndroidï¼‰çš„ç»Ÿä¸€æ”¯æŒã€‚

**é¡¹ç›®ç›®æ ‡**ï¼š
æ„å»ºä¸€ä¸ª**ä½é—¨æ§›ã€é«˜ç¨³å®šæ€§ã€å¤šç«¯æ”¯æŒ**çš„æ™ºèƒ½åŒ– UI è‡ªåŠ¨åŒ–æµ‹è¯•å¹³å° (PoC)ï¼Œå…è®¸éæŠ€æœ¯äººå‘˜é€šè¿‡**è‡ªç„¶è¯­è¨€**ç¼–å†™ç”¨ä¾‹ã€‚

---

## 2. æ ¸å¿ƒäº§å‡ºä¸æŠ€æœ¯äº®ç‚¹ (Action & Result)

åŸºäº **STAR æ³•åˆ™** æ¢³ç†çš„æ ¸å¿ƒå·¥ä½œæˆæœï¼š

### ğŸŒŸ L1: å…¨æ ˆæ¶æ„æ­å»º (Infrastructure)
*   **å…¨æ ˆå¼€å‘**ï¼šç‹¬ç«‹æ­å»ºäº†åŸºäº **React 19 + TypeScript + Vite** çš„å‰ç«¯å’Œ **Node.js + Express** çš„åç«¯æ¶æ„ã€‚
*   **è½»é‡åŒ–å­˜å‚¨**ï¼šè®¾è®¡äº†åŸºäº JSON æ–‡ä»¶ç³»ç»Ÿçš„ NoSQL-like å­˜å‚¨æ–¹æ¡ˆï¼Œå®ç°äº†**é›¶ä¾èµ– (Zero-Dependency)** éƒ¨ç½²ï¼Œä¸‹è½½å³ç”¨ã€‚
*   **å·¥ç¨‹åŒ–å®è·µ**ï¼šé…ç½®äº† ESLint ä»£ç è§„èŒƒï¼Œç¼–å†™äº† `start.sh` ä¸€é”®å¯åŠ¨è„šæœ¬å’Œ `gitpush.sh` è‡ªåŠ¨åŒ–æäº¤è„šæœ¬ï¼Œæå‡å¼€å‘æ•ˆç‡ã€‚

### ğŸš€ L2: æ ¸å¿ƒæŠ€æœ¯æ”»åš (Core Tech)
*   **AI é©±åŠ¨æ‰§è¡Œ**ï¼šé›†æˆ **MidScene AI Agent**ï¼Œå®ç°äº†â€œè‡ªç„¶è¯­è¨€ -> è‡ªåŠ¨åŒ–æŒ‡ä»¤â€çš„è¯­ä¹‰è½¬åŒ–ï¼ˆå¦‚â€œç‚¹å‡»æœç´¢æ¡†â€ï¼‰ï¼Œå½»åº•è§£å†³äº†é€‰æ‹©å™¨ç»´æŠ¤éš¾é¢˜ã€‚
*   **Android è‡ªåŠ¨åŒ–çªç ´**ï¼š
    *   æ”»å…‹äº† ADB Shell äº¤äº’éš¾é¢˜ï¼Œå®ç°äº† Android çœŸæœº/æ¨¡æ‹Ÿå™¨çš„è‡ªåŠ¨åŒ–æ§åˆ¶ã€‚
    *   **éš¾ç‚¹è§£å†³**ï¼šé’ˆå¯¹ Android è¾“å…¥æ³•ä¸æ”¯æŒä¸­æ–‡è¾“å…¥çš„é—®é¢˜ï¼Œé€šè¿‡ `adb shell input keyevent` + å‰ªè´´æ¿æ³¨å…¥çš„æ–¹å¼å®ç°äº†ç¨³å®šè¾“å…¥ã€‚
*   **å¤šç«¯ç»Ÿä¸€æŠ½è±¡**ï¼šè®¾è®¡äº†ç»Ÿä¸€çš„ Runner æ¥å£ï¼Œå±è”½äº† Web (Playwright) å’Œ Android (ADB) çš„åº•å±‚å·®å¼‚ï¼Œå¯¹å¤–æä¾›ä¸€è‡´çš„ APIã€‚

### ğŸ›¡ L3: ç³»ç»Ÿç¨³å®šæ€§ä¿éšœ (Stability)
*   **å¹¶å‘æ§åˆ¶é˜Ÿåˆ—**ï¼šå®ç°äº†å†…å­˜ä»»åŠ¡é˜Ÿåˆ— (In-Memory Queue)ï¼Œæ”¯æŒ**æ‰¹é‡æ‰§è¡Œ**ï¼Œå¹¶è®¾ç½®äº†æœ€å¤§å¹¶å‘æ•° (Max=5)ï¼Œé˜²æ­¢èµ„æºè€—å°½ã€‚
*   **å®æ—¶çŠ¶æ€åé¦ˆ**ï¼šåŸºäº **WebSocket** å®ç°äº†å…¨é“¾è·¯çš„å®æ—¶æ—¥å¿—æ¨é€ï¼Œç”¨æˆ·å¯å³æ—¶çœ‹åˆ°â€œæ­£åœ¨æ‰“å¼€æµè§ˆå™¨â€ã€â€œæ­£åœ¨ç‚¹å‡»æŒ‰é’®â€ç­‰çŠ¶æ€ã€‚
*   **çŠ¶æ€è‡ªæ„ˆæœºåˆ¶**ï¼šè®¾è®¡äº†æœåŠ¡å¯åŠ¨æ—¶çš„çŠ¶æ€æ£€æŸ¥é€»è¾‘ï¼Œè‡ªåŠ¨å°†å¼‚å¸¸ä¸­æ–­ï¼ˆå¦‚æœåŠ¡å´©æºƒï¼‰çš„ä»»åŠ¡æ ‡è®°ä¸º Failedï¼Œé˜²æ­¢â€œåƒµå°¸ä»»åŠ¡â€é˜»å¡é˜Ÿåˆ—ã€‚
*   **ä¸€é”®åº”æ€¥åœæ­¢**ï¼šå®ç°äº† `/api/admin/stop-all` æ¥å£ï¼Œå¯å¼ºåˆ¶ç»ˆæ­¢æ‰€æœ‰è¿è¡Œä¸­ä»»åŠ¡ï¼Œä¿éšœç³»ç»Ÿå®‰å…¨ã€‚

---

## 3. ä»£ç å¯¼è¯» (Code Walkthrough)

å»ºè®®æŒ‰ç…§**æ•°æ®æµå‘**é˜…è¯»ä»£ç ï¼Œè€ŒéæŒ‰æ–‡ä»¶é¡ºåºã€‚

### ğŸ›£ è·¯çº¿ 1: ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹çš„ç”Ÿå‘½å‘¨æœŸ (CRUD)
1.  **å‰ç«¯å‘èµ·**ï¼šç”¨æˆ·åœ¨ `src/App.tsx` å¡«å†™è¡¨å•ï¼Œè°ƒç”¨ `POST /api/testcases`ã€‚
2.  **åç«¯æ¥æ”¶**ï¼š`server/index.ts` è·¯ç”±å¤„ç†è¯·æ±‚ã€‚
3.  **æŒä¹…åŒ–**ï¼š`server/storage.ts` ä¸­çš„ `saveCase()` æ–¹æ³•ç”Ÿæˆå”¯ä¸€ IDï¼Œå¹¶å°†æ•°æ®å†™å…¥ `data/testcases/*.json`ã€‚

### ğŸ›£ è·¯çº¿ 2: è‡ªåŠ¨åŒ–ä»»åŠ¡çš„è°ƒåº¦ä¸æ‰§è¡Œ (Core Logic)
è¿™æ˜¯ç³»ç»Ÿçš„æ ¸å¿ƒå¿ƒè„ï¼Œç†è§£äº†è¿™é‡Œå°±ç†è§£äº† 80% çš„é€»è¾‘ã€‚

1.  **å…¥é˜Ÿ (Enqueue)**ï¼š
    *   è¯·æ±‚ `POST /api/executions` åˆ°è¾¾åç«¯ã€‚
    *   `server/index.ts` å°†ä»»åŠ¡æ¨å…¥ `executionQueue` æ•°ç»„ï¼ŒçŠ¶æ€ç½®ä¸º `queued`ã€‚
    *   è§¦å‘ `processQueue()` è°ƒåº¦å™¨ã€‚

2.  **è°ƒåº¦ (Dispatch)**ï¼š
    *   `processQueue()` æ£€æŸ¥å½“å‰è¿è¡Œæ•° `runningCount` æ˜¯å¦å°äºé˜ˆå€¼ (5)ã€‚
    *   è‹¥æ»¡è¶³ï¼Œä»é˜Ÿåˆ—å¤´éƒ¨å–å‡ºä»»åŠ¡ï¼ŒçŠ¶æ€æ›´æ–°ä¸º `running`ã€‚

3.  **æ‰§è¡Œ (Execute)**ï¼š
    *   æ ¹æ® `platform` å­—æ®µåˆ†å‘ï¼š
        *   **Web ä»»åŠ¡**ï¼šè¿›å…¥ `server/runner.ts` -> `runWebTask()`ã€‚åˆå§‹åŒ– Playwright å’Œ MidScene Agentã€‚
        *   **Android ä»»åŠ¡**ï¼šè¿›å…¥ `server/runner.android.ts` -> `runAndroidTask()`ã€‚åˆå§‹åŒ– ADB è¿æ¥ã€‚
    *   **AI è§£æ**ï¼šè°ƒç”¨ `mid.aiAction(step)`ï¼Œå°†è‡ªç„¶è¯­è¨€æ­¥éª¤è½¬åŒ–ä¸ºå…·ä½“æ“ä½œã€‚

4.  **åé¦ˆ (Feedback)**ï¼š
    *   Runner å†…éƒ¨é€šè¿‡ `broadcast()` å‡½æ•°å‘é€ WebSocket æ¶ˆæ¯ã€‚
    *   å‰ç«¯ `src/App.tsx` ä¸­çš„ `ws.onmessage` ç›‘å¬æ¶ˆæ¯ï¼Œå®æ—¶æ›´æ–° UI è¿›åº¦æ¡ã€‚

### ğŸ›£ è·¯çº¿ 3: å¼‚å¸¸å¤„ç†ä¸å…œåº•
*   **ä¸€é”®åœæ­¢**ï¼š`server/index.ts` ä¸­çš„ `/api/admin/stop-all` æ¥å£ï¼Œéå† `runningExecutions` Mapï¼Œè°ƒç”¨ `AbortController` ä¸­æ–­ä»»åŠ¡ã€‚
*   **å¯åŠ¨é‡ç½®**ï¼š`server/index.ts` åœ¨ `server.listen` å›è°ƒä¸­è°ƒç”¨ `Storage.resetPendingExecutions()`ï¼Œä¿®å¤å¼‚å¸¸çŠ¶æ€ã€‚

---

## 4. ç›®å½•ç»“æ„è¯´æ˜

```bash
ui-automation-demo/
â”œâ”€â”€ data/               # [æ ¸å¿ƒ] æ•°æ®å­˜å‚¨å±‚ (JSON)
â”œâ”€â”€ server/             # [æ ¸å¿ƒ] åç«¯æœåŠ¡
â”‚   â”œâ”€â”€ index.ts        # å…¥å£ã€API è·¯ç”±ã€é˜Ÿåˆ—è°ƒåº¦
â”‚   â”œâ”€â”€ runner.ts       # Web æ‰§è¡Œå¼•æ“ (Playwright)
â”‚   â”œâ”€â”€ runner.android.ts # Android æ‰§è¡Œå¼•æ“ (ADB)
â”‚   â””â”€â”€ storage.ts      # æ•°æ®è¯»å†™ä¸çŠ¶æ€ç®¡ç†
â”œâ”€â”€ src/                # å‰ç«¯åº”ç”¨ (React)
â”œâ”€â”€ docs/               # é¡¹ç›®æ–‡æ¡£
â”œâ”€â”€ start.sh            # ä¸€é”®å¯åŠ¨è„šæœ¬
â””â”€â”€ gitpush.sh          # ä¸€é”®æäº¤è„šæœ¬
```

---

## 5. æœªæ¥è§„åˆ’ä¸å»ºè®® (Future Work)

å¦‚æœé¡¹ç›®éœ€è¦è¿›ä¸€æ­¥æ¼”è¿›åˆ°ç”Ÿäº§ç¯å¢ƒï¼Œå»ºè®®è€ƒè™‘ï¼š

1.  **å­˜å‚¨å‡çº§**ï¼šå°† JSON æ–‡ä»¶å­˜å‚¨è¿ç§»è‡³ **SQLite** æˆ– **MySQL**ï¼Œä»¥æ”¯æŒæµ·é‡å†å²æ•°æ®çš„æŸ¥è¯¢ä¸åˆ†æã€‚
2.  **åˆ†å¸ƒå¼æ‰§è¡Œ**ï¼šå°† Runner å‰¥ç¦»ä¸ºç‹¬ç«‹æœåŠ¡ï¼Œé‡‡ç”¨ **Master-Worker** æ¶æ„ï¼Œæ”¯æŒå¤šå°æœºå™¨åˆ†å¸ƒå¼å¹¶å‘æ‰§è¡Œã€‚
3.  **äº‘çœŸæœºæ¥å…¥**ï¼šAndroid Runner é€‚é… STF æˆ– BrowserStack ç­‰äº‘çœŸæœºå¹³å°ï¼Œæ‘†è„±æœ¬åœ° USB è¿æ¥é™åˆ¶ã€‚
4.  **CI/CD é›†æˆ**ï¼šæä¾› CLI å·¥å…·ï¼Œæ”¯æŒåœ¨ Jenkins/GitLab CI æµæ°´çº¿ä¸­ç›´æ¥è§¦å‘æµ‹è¯•å¹¶ç”ŸæˆæŠ¥å‘Šã€‚
